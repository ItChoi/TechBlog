# 01. 영화 예매 시스템

## 01.1 요구사항 살펴보기

---

# 02. 객체지향 프로그래밍을 향해
서적의 코드에서는 적당한 수준의 난이도, 복잡도를 선택해야 한다.  
결론적으로, 쉬운 코드로 예제를 구성 했더라도, 복잡한 예제라고 생각하고 고민 포인트를 늘려 생각해야 한다.  
  
- 예제 
  - 영화 예매 시스템
    - 요구사항
      - 이용자는 영화 예매 시스템을 통해 쉽고 빠르게 영화 예매를 할 수 있다.
      - '영화', '상영' 용어 구분 필요
        - 실제 얘매 대상은 영화가 아니라, 상영이다.
        - 영화: 영화에 대한 기본 정보
        - 상영: 실제 관객들이 영화를 관람하는 사건 표현
          - 상영 일자, 시간, 순번 등
      - 하나의 영화는 다양한 시간대에 걸쳐 한 번 이상 상영 될 수 있다.
      - 특정 조건 만족 예매자는 요금 할인
      - 할인액 결정 두 가지 규칙
        1. 할인 조건 (discount condition)
           - 순서 조건: 상영 순번을 이용, 순번이 10인 경우 매일 10번 째 상영 영화 예매자 할인 혜택 제공
           - 기간 조건: 요일, 시작 시간, 종료 시간 세 부분으로 구성, 포함 될 경우 요금 할인
           - 순서 조건과 기간 조건 섞어서 조건을 줄 수도 있다.
        2. 할인 정책 (discount policy)
           - 할인 요금 결정
             1. 금액 할인 정책 (amount discount policy)
                - 800원 할인, 예약 인원 수 대로 n * 800 할인
             2. 비율 할인 정책 (percent discount policy)
                - 10% 할인
           - 영화 별로 하나의 할인 정책만 할당 가능, 할당하지 않을 수도 있다.
      - 할인 적용은 '할인 조건'과 '할인 정책'을 함께 조합해 사용한다.
  - 프로세스
    1. 이용자 예매 정보가 '할인 조건' 중 하나라도 만족하는지 검사
    2. 만족하는 경우 '할인 정책'을 이용해 할인 요금 계산
    3. 그 외 기본 요금 결제
  - 예매 데이터 정보
    - 제목: 아바타
    - 상영 정보: 2019.12.26 목, 7회 18:00 ~ 20:00
    - 인원: 2명
    - 정가: 20,000원
    - 결제 금액: 18,400원
    
## 02.1 협력, 객체, 클래스
객체지향은 객체를 지향하는 것이다.  
당연하다는 생각과 별개로 실제로 코드를 객체 지향적으로 짰는가 생각 해 볼 필요가 있다.  
  
가장 먼저 무엇을 고민해야할까?  
클래스? 클래스 속성과 메서드?  
위 항목은 객체지향의 본질과는 거리가 있다.  
  
객체를 지향하려면 어떻게 해야 할까?  
객체에 초점을 맞추기 위해 두 가지에 집중해야 한다.  
1. 어떤 객체들이 필요한지 고민
   - 클래스 윤곽을 잡기 전, 어떤 객체들이 어떤 '상태'와 '행동'을 가지는지 먼저 결정해야 한다.
   - 객체 중심 접근 방법은 설계를 단순하고 깔끔하게 만든다.
2. 객체를 기능 구현을 위해 협력하는 공동체의 일원으로 봐야한다.
   - 하나의 객체로 존재하는 것이 아니라, 다른 객체에 도움을 주거나 의존하는 협력적인 존재다.
   - 공동체의 일원으로 바라보는 것은 설계를 유연하고 확장 가능하게 만든다.
- 객체들의 모양과 윤곽이 잡히면 공통 특성, 상태를 가진 객체들을 타입으로 분류하고 타입 기반으로 클래스 구현
  
## 02.2 도메인의 구조를 따르는 프로그램 구조
영화 예매 시스템 목적은 영화를 더 쉽고 빠르게 예매를 하려는 이용자의 문제를 해결하려고 나온 '도메인'이다.  
문제 해결을 위해 이용자, 사용자가 프로그램을 사용하는 분야를 '도메인'이라고 부른다.  
  
도메인 구성 개념들이 객체와 클래스로 매끄럽게 연결 될 수 있다.  
0..1 또는 1..*을 통해 할당 종류, 할당 여부와 할당 개수를 알 수 있다. (p.42)  
- 클래스
  - Movie (영화)
  - Screening (상영)
  - DiscountPolicy (할인 정책)
    - AmountDiscountPolicy (금액 할인 정책)
    - PercentDiscountPolicy (비율 할인 정책)
  - DiscountCondition (할인 조건)
    - SequenceCondition (순번 조건)
    - PeriodCondition (기간 조건)
  - Reservation (예매)

## 02.3 클래스 구현하기
적절한 클래스 구조를 만들었다면, 이 구조를 구현하는 것이다.   
변수의 가시성은 private, 메서드의 가시성은 public이다.  
클래스의 경계를 구분 짓는 것은 중요하다. 즉 어떤 부분을 공개하고, 감출 지를 결정해야 한다.  
  
그런데 클래스의 내부, 외부를 구분해야 하는 이유가 뭘까?  
바로 경계의 명확성은 객체의 자율성을 보장하고, 개발자에게 구현의 자유를 제공한다.  
  
- 자율적인 객체
  - 객체는 '상태'와 '행동'을 함께 가지는 복합적인 존재다.
    - 일반적으로 객체 상태는 숨기고, 행동만 외부에 공개
  - 스스로 판단하고 행동하는 자율적인 존재다.
  - 데이터와 기능을 객체 내부로 함께 묶는 것을 '캡슐화'라고 부른다.
  - OOP는 캡슐화를 넘어 '접근 제어' 메커니즘도 함께 제공
    - 접근 제어자 (public, protected, private, ...)
  - 객체 내부 접근 통제는 자율적인 객체로 존재하게 해준다.
    - 스스로 상태 관리, 판단, 행동 즉 외부 간섭을 최소화 해야 한다.
  - 퍼블릭 '인터페이스'와 내부 접근의 '구현'의 분리를 하는 것이 OOP의 핵심 원칙이다.
- 프로그래머의 자유
  - 인터페이스만 공개하고, 내부 구현은 숨긴다. (구현 은닉)
    - 즉 구현을 직접 변경하는 사람과, 사용하는 사람을 나눈다.
    - 클래스 내부와 외부를 명확하게 경계 지을 수 있다.
  - 객체 변경을 관리하는 기법 중 대표적인 것이 '접근 제어'다.
  - 변경으로 인한 혼란을 최소화 할 수 있다.

## 02.4 협력하는 객체들의 공동체
## 02.5 협력에 관한 짧은 이야기

---

# 03. 할인 요금 구하기

## 03.1 할인 요금 계산을 위한 협력 시작하기
## 03.2 할인 정책과 할인 조건
## 03.3 할인 정책 구성하기

---

# 04. 상속과 다형성

## 04.1 컴파일 시간 의존성과 실행 시간 의존성
## 04.2 차이에 의한 프로그래밍
## 04.3 상속과 인터페이스
## 04.4 다형성
## 04.5 인터페이스와 다형성

---

# 05. 추상화와 유연성

## 05.1 추상화의 힘
## 05.2 유연한 설계
## 05.3 추상 클래스와 인터페이스 트레이드오프
## 05.4 코드 재사용
## 05.5 상속
## 05.6 합성

---