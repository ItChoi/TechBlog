# 서론
객체지향 패러다임 관점에서 핵심은 세 가지다.
1. 역할(Role)
2. 책임(Responsibility)
3. 협력(collaboration)
이 세가지는 객체지향의 본질이라고 볼 수 있다.  
앞서 상속, 다형성을 통한 지연 바인딩, 컴파일/실행시간 의존성, 합성 등 중요한 개념을 배웠지만 구현 측면에 치우쳐 있다.  
  
즉 객체지향의 본질은 객체간 협력 관계를 맺는 것이다.  
그 과정에서 협력 구성을 위한 적절한 객체를 찾고, 책임을 할당한다.  
  
객체간 협력 관계를 맺고, 책임을 할당 한 후 앞서 배운 구현을 진행하면 된다.   
APP 기능 구현을 위해 객체간 협력, 역할, 책임을 먼저 정해야 한다.  
구현에 초점을 맞춘 설계와 코드는 변경하기 어렵고 유연하지 못한 원인이 된다.  
  
--- 

# 01. 협력
다시 한 번 강조하지만, 객체지향에서 중요한 것은 역할, 책임, 협력을 구축하는 것이다.  

## 01.1 영화 예매 시스템 돌아보기
- User
  - Screening (reserve(customer, audienceCount))
    - Movie (calculateMovieFee(screening))
      - AmountDiscountPolicy(calculateDiscountAmount(screening))
        - PeriodCondition(isSatisfiedBy(screening))
        - SequenceCondition(isSatisfiedBy(screening))
    - Reservation (create)
  
영화 예매 APP 흐름만 보더라도, 다양한 객체에 로직을 분배하고, 요청 흐름에 따라 실행하며 App의 완성도를 높인다.  
즉 다양한 객체들이 기능 구현을 위해 서로 메시지를 주고 받으며 상호작용한다. 이를 **협력**이라 한다.  
협력에 참여하는 객체가 수행하는 로직을 **책임**이라 한다.  
협력안에서 객체들이 수행하는 책임들이 모여 객체가 수행하는 **역할**을 구성한다.  
  
정리하자면 다음과 같다.
1. 협력: 기능 구현을 위해 객체간 메시지를 통해 상호작용
2. 책임: 협력 안에서 객체가 수행하는 로직
3. 역할: 책임들이 모여 역할 구성 (? 이건 잘 와닿지가 않네)  

## 01.2 협력
객체는 고립된 존재가 아니라, 자율적인 객체들의 공동체이자 객체간 협력하는 사회적인 존재다.  
협력을 통해 기능을 유일하게 구현한다.  
두 객체의 협력은 **메시지**를 통해 시작된다.  
객체간 내부에 자세하게 접근할 수 없기 때문에 객체간 유일한 커뮤니케이션인 **메시지**를 통해 요청을 전달한다.   
두 객체의 상호작용을 통해 더 큰 책임을 수행한다.  
  
메시지 수신 객체는 메서드를 통해 요청에 응답한다.  
메시지 처리는 메시지를 요청하는 객체가 아닌, 수신하는 객체가 처리 방법을 스스로 결정한다. -> 자율적인 존재  
- 예시
  - Screening calculateMovieFee(screening) -> Movie

Screening은 Movie에게 처리를 위임한다.  
영화의 기본 요금, 할인 정책은 Movie 객체가 더 잘 알고 있다.  
Screening이 Movie 내부 구현에 직접 접근한다면, Movie는 수동적인 존재로 전락한다.  
Movie는 자신의 정보를 이용해 직접 요금계산을 해야 객체들의 전체적인 자율성을 향상시킨다.  
즉 객체들의 자율성 보장을 위해 내부 구현을 캡슐화가 필요하다.  
  
자율적인 객체는 자신의 책임을 수행 중 필요한 정보가 생기면 다른 객체에 메시지를 전송한다.  
이처럼 객체간 협력 구성을 통해 App의 기능이 구현된다.  

## 01.3 협력이 설계를 위한 문맥을 결정한다
객체란 상태와 행동을 함께 캡슐화하는 실행 단위다.  
객체의 상태와 행동을 어떤 기준으로 결정할까?  
객체간 협력을 구성할 때, 각 객체는 협력에 필요한 적절한 행동을 보유하고 있다.  
즉 객체 행동을 결정하는 것은 **협력**이다.  
협력이 바뀌면 객체 행동도 같이 변경돼야 한다.  
  
- Movie를 통한 고민 포인트
  - Movie 객체는 어떤 것을 수행할 수 있어야 할까?
    - 영화 상영?
    - 요금 계산?  

Movie 객체 안 영화 상영 행위는 없다.  
오히려 단순히 생각했을 때 어울리지 않는 요금 계산 행위가 존재한다.  
이는 Movie 객체가 '영화 예매 시스템' App 안에서 영화 예매를 위한 협력으로 참여하고 있고, 요금 계산을 책임지기 때문이다.  
  
즉 Movie의 행동 결정은 '영화 예매 협력'이다.  
협력을 고려하지 않고 행동을 결정하는 것은 의미가 없다.  
협력이 있고 그 다음 객체가 존재하기 때문이다.  
  
객체의 행동은 협력을 통해 결정되고,  
객체의 상태는 행동을 통해 결정된다.  
어쨋든 협력을 통해 행동과 상태가 결정된다.
  
Movie 객체 안 Money fee, DiscountPolicy discountPolicy 두 변수 모두 서적에서는 상태의 일부로 포함한다.  
계산 행동을 수행함에 있어서 필요한 정보들이기 때문이다.  
단순히 status, type 등을 상태로 보지 않고, 행동에 필요한 데이터도 상태의 일부로 본다.  

결과적으로 협력은 객체 설계에 필요한 문맥을 제공한다.  

---

# 02. 책임

## 02.1 책임이란 무엇인가
객체 설계를 위해 필요한 협력을 갖춘 후 행동 수행을 위한 적절한 객체를 찾는다.  
객체가 수행하는 행동을 책임이라 한다.  
  
객체의 책임은 두 가지 범주로 나누어 세분화하고 있다.
1. 객체가 무엇을 알고 있는가? (아는 것)
   - 사적인 정보
   - 관련 객체
   - 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것 (?)
2. 객체가 무엇을 할 수 있는가? (하는 것)
   - 객체 생성, 계산 수행 등 스스로 하는 것
   - 다른 객체의 행동을 시작시키는 것
   - 다른 객체의 활동을 제어, 조절하는 것

Screening 책임 -> 영화 예매 (아는 것)  
Movie 책임 -> 요금 계산 (하는 것)  
Movie 책임 -> 가격, 적용된 할인 정책 (아는 것)  
  
협력 안에서 객체에 할당된 책임이 외부 인터페이스와 내부 속성을 결정한다.  
- Screeing 객체는 reverse 메시지 수신, movie 인스턴스 변수 포함 -> 영화 예매 책임 
- Movie 객체는 calculateMovieFee 메시지 수신, 가격/할인정책 속성 포함 -> 가격 계산 책임
  
일반적으로 책임 > 메시지이다.  
책임은 객체 수행 행동을 종합적이고 간략하게 서술한다.  
단순한 책임도 여러 개 메시지로 분할되기도 하고, 더 다양한 객체와 협력해야하는 커다란 책임으로 자라는 것이 일반적이다.  
  
책임 관점에서 '아는 것'과 '하는 것'은 밀접히 연관돼 있다.  
객체는 책임에 필요한 정보와 메시지를 보낼 객체를 알고 있을 책임이 있다.  
  
책임을 능숙하게 객체에 할당하는 것은 어렵지만 핵심이다.  
적절한 협력이 적절한 책임을 제공하고, 객체에 적합한 책임을 할당해야만 품질과 단순하고 유연할 설계를 만들 수 있다.  
  
객체지향 설계에서 가장 중요한 것은 **책임**이다.  
구현 방법은 책임보다 상대적으로 덜 중요하다.  
책임을 결정한 후 구현 방법을 고민하도록 하자.  
  
- CRC 카드
  - Candidate (후보)
  - Responsibility (책임)
  - Collaborator (협력자)
  - 객체지향 설계 기법 고안 기법이다.
  - 하나의 카드는 협력에 참여하는 하나의 후보(역할, 객체, 클래스, ...)
  - 뒷 면에 후보의 목적 기술 (개별 상용 정보, 실제 예매 대상)
  - 앞 면에 후보 이름, 세분화된 목적, 책임을 적는다.

## 02.2 책임 할당
자율적인 객체를 만들기 위해선, 책임 수행에 필요한 정보를 잘 아는 객체에게 책임을 할당해야 한다.  
이를 책임 할당을 위한 정보 전문가 패턴이라 한다.  
  
책임 할당 전 협력이라는 문맥을 정의해야 한다.  
협력 설계의 출발점은 App의 기능을 시스템이 담당할 하나의 책임으로 바라보는 것이다.  
시스템의 책임을 완료하는 데 필요한 더 작은 책임들을 찾아내 객체에게 할당하는 것을 반복하며 객체지향 설계 모양을 맞춰야 한다.  
  
영화 예매 시스템 예제로 돌아가 정보 전문가 패턴을 통해 책임 할당하는 방법을 살펴보자.  
- App 기능 -> 영화 예매 (시스템 책임) 
1. '예매 하라' 메시지를 통해 협력을 시작한다.
2. 메시지 처리 객체 선택
3. 영화 예매 책임 -> 정보 전문가에게 할당 -> 영화 예매는 상영 시간, 기본 요금을 알아야 한다. -> Screenng
4. 영화 예매를 위해 예매 가격 계산 필요
5. Screenng 객체에 '가격을 계산하라' 새로운 메시지 추가
6. 메시지 처리 객체 선택 
7. 가격 계산 책임 -> 정보 전문가에게 할당 -> 가격 계산은 가격과 할인 정책을 알아야 한다 -> Movie
8. 가격 계산을 위해 할인 요금 필요
9. '할인 요금 계산하라' 새로운 메시지 추가

위와 같은 순서로 협력에 필요한 메시지를 찾고, 적절한 객체 선택을 반복하는 과정을 통해 설계가 이뤄진다.  
협력을 설계하며 객체 책임 식별하는 과정의 결과물은 시스템 구성 객체 인터페이스와 오퍼레이션 목록이다.  
  
무조건 정보 전문가에게 책임을 할당하진 않는다. 응집도와 결합도 관점에서 다른 객체에게 할당하는 것이 적절할 때도 있다.  
그러나 정보 전문가에게 할당하는 것이 상태, 행동을 함께 가지는 자율적인 객체로 만들 가능성이 높다.

## 02.3 책임 주도 설계
## 02.4 메시지가 객체를 결정한다
## 02.5 행동이 상태를 결정한다

---

# 03. 역할

## 03.1 역할과 협력
## 03.2 유연하고 재사용 가능한 협력
## 03.3 객체 대 역할
## 03.4 역할과 추상화
## 03.5 배우와 배역

---
