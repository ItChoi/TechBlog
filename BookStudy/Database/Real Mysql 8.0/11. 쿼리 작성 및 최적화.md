# 11. 쿼리 작성 및 최적화
```text
 쿼리가 빠르게 동작하기 위해서는 어떻게 처리할지 예측할 수 있어야 한다.
데이터베이스를 통해 몇 십 배 성능 향상은 흔한 일이다. 따라서 쿼리를 어떻게 작성하고 처리 되는지 이해가 필요하다.
```

## 11.1 쿼리 작성과 연관된 시스템 변수
```text
 SQL 작성 규칙은 MYSQL 서버 시스템 설정에 따라 달라진다.
```

### 11.1.1 SQL 모드
```text
 sql_mode 시스템 설정은 여러 값을 설정할 수 있다.
테이블이 생성되고 데이터가 저장되면 그 이후로는 해당 시스템 설정을 바꾸지 않는 것이 좋다.
익숙하지 않다면 기본 값을 사용하자. 

- STRICT_ALL_TABLES & STRICT_TRANS_TABLES
  등록, 수정시 컬럼 타입과 다른 값이 들어오는 경우 자동으로 타입 변환을 수행한다.
 변환되기 어려운 경우 실행/에러도 결정 가능하다. 
 STRICT_ALL_TABLES: 모든 스토리지 엔진에 대해 엄격 모드 적용
 STRICT_TRANS_TABLES: 자동 변환을 막기 위해 서비스 적용 전 반드시 활성을 권장
 
- ANSI_QUOTES
  문자열 값(리터럴) 표현을 위해 홑따옴표, 쌍따옴표 동시 사용 가능
  
- ONLY_FULL_GROUP_BY
  5.7 까지는 기본 값이 비활성이지만, 8.0부터 기본 값이 활성이다.
 활성시 GROUP BY에 SELECT된 컬럼만 사용가능하다. 집계함수의 경우 명시되지 않더라도 사용가능하다.
 
- PIPE_AS_CONCAT
  ||는 OR 연산자와 같은 의미이지만, 이 옵션 설정시 문자열 연결 연산자(CONCAT)으로 사용 가능
  
- PAD_CHAR_TO_FULL_LENGTH
  기본적으로 CHAR 타입은 VARCHAR와 같이 유효 문자열 뒤 공백 문자 제거 후 반환되는데, 
  이 값의 설정을 통해 공백 문자 제거 없이 반환 가능하다.
  
- NO_BACKSLASH_ESCAPES
  설정시 역슬래시를 문자 이스케이프 용도로 사용하지 못한다.
  
- IGNORE_SPACE
  프로시저 이름 뒤 공백을 프로시저명으로 인식하지 않을 수 있도록 해준다.
  
- REAL_AS_FLOAT
  REAL -> DOUBLE에서 REAL -> #FLOAT로 바뀐다.
  
- NO_ZERO_IN_DATE & NO_ZERO_DATE
  두 옵션 활성시 잘못된 날짜 형식 저장 불가능, 실제 존재 날짜만 저장 가능하다.
  
- ANSI
  최대한 SQL 표준에 맞게 동작하게 만들어준다.
  
- TRADITIONAL
  여러 옵션 조합
```

### 11.1.2 영문 대소문자 구분
```text
 MYSQL 서버는 설치된 운영체제에 따라 테이블명 대소문자 구분한다. DB나 테이블이 디스크의 디렉토리나 파일로 매핑되기 때문이다.
대소문자 구분 없애려면 lower_case_table_names 시스템 변수 설정을 하면 된다.
```

### 11.1.3 MySQL 예약어
```text
 테이블 생성시 항상 역따옴표(`)로 테이블이나 컬럼 이름을 감싸지 않은 상태로 생성하길 권장한다. 
```

## 11.2 매뉴얼의 SQL 문법 표기를 읽는 방법

## 11.3 MySQL 연산자와 내장 함수
```text
 MYSQL 전용 연산자가 있는데, 가능하면 SQL 가독성을 위해 ANSI 표준 연산자를 사용하길 권장한다.
```

### 11.3.1 리터럴 표기 문자열

#### 11.3.1.1 문자열 - 패스

#### 11.3.1.2 숫자 - 패스

#### 11.3.1.2 숫자 - 날짜
```text
 다른 DBMS에서 날짜 타입을 비교하거나 등록시 문자열 -> DATE 타입 변환 코드 필요하다.
그러나 MYSQL은 자동으로 DATE나 DATETIME 값으로 변환해준다.
```

#### 11.3.1.4 불리언
```text
 BOOL, BOOLEAN 타입은 TINYINT 타입에 대한 동의어일뿐이다.
BOOL 타입 뿐만 아니라 숫자 타입에도 적용 가능 (TRUE, FALSE)
즉 TRUE, FALSE는 정수로 매핑해서 사용한다. (0, 1)
BOOLEAN 타입을 꼭 사용해야 할 경우 ENUM 타입으로 관리
```

### 11.3.2 MYSQL 연산자

#### 11.3.2.1 동등(Equal) 비교(=, <=>)
```text
 동등 비교 =, <=>를 제공하는데, <=>는 NULL 비교까지 수행  
NULL은 ISNULL 연산자 이외에 비교 방법이 없다. 하지만 <=> (Null-Safe)를 통해 비교 NULL <=> NULL 비교 가능
NULL을 하나의 값으로 인식하교 비교
```

#### 11.3.2.2 부정 (Not-Equal) 비교 (<>, !=)
```text
 무엇을 사용해도 괜찮지만, 통일된 방식으로 사용하길 권장
```

#### 11.3.2.3 NOT 연산자 (!) - 패스

#### 11.3.2.4 AND(&&)와 OR(||) 연산자
```text
 오라클 ||는 문자를 연결한다. MYSQL에서는 OR 연산자로 사용가능한데, 시스템 변수를 통해 용도 변경 가능하다.
```

#### 11.3.2.5 나누기(/, DIV)와 나머지(%, MOD) 연산자 - 패스

#### 11.3.2.6 REGEXP 연산자
```text
 문자열 값이 어떤 패턴을 만족하는지 체크한다. RLIKE, REGEXP는 똑같은 비교를 수행한다.
```

#### 11.3.2.7 LIKE 연산자
```text
 LIKE 'start%' -> 인덱스 레인지 스캔을 통해 검색 가능 
 LIKE '%end' -> 인덱스 풀 스캔 방식
```

#### 11.3.2.8 BETWEEN 연산자
```text
 동등 조건이 아니라 크거나 같다, 같거나 크다기 때문에 모든 인덱스 범위 검색해야 한다.
BETWEEN은 범위 검색, IN은 여러 개를 동등 비교해서 성능을 최적화 할 수 있다.
```

#### 11.3.2.9 IN 연산자
```text

```































































