# 30장 데이터베이스는 세부사항이다
SOLID 원칙이 벽과 벽돌을 배치하는 방법을 알려준다면,
컴포넌트 원칙은 빌딩에 방을 배치하는 벽
DB의 역할은 방과 방 사이를 연결하는 문 손잡이다.

데이터베이스는 데이터 모델이 아니라 일개 SW일뿐이다.
즉 데이터 접근 방법을 제공하는 유틸리티다.
아키텍처 관점에서 DB는 저수준 세부사항일 뿐이다.
뛰어난 아키텍트는 저수준이 시스템 아키텍처를 오염시키지 않게 한다.

**관계형 데이터베이스**
관계형 데이터베이스가 정의되고 계속적으로 인기를 끌었다.
하지만 아키텍처 관점에서 그저 기술일뿐이다. 즉 저수준의 세부사항이다.
데이터를 어떻게 조회하고, 얼마만큼의 성능으로 가져올지는 아키텍처적으로는 중요하지 않다.
애플리케이션의 유스케이스는 이러한 방식을 알면 안되고 관여해서도 안된다.

많은 프레임워크가 테이블과 행이 객체 형태로 시스템 여기 저기 돌아다니게 허용하는데, 아키텍처적으로 잘못된 설계다.
이렇게 된다면, 관계형 데이터 구조에 결합되어 버린다.

**데이터베이스 시스템은 왜 이렇게 널리 사용되는가?**
한마디로 "디스크" 덕분이다.
지난 반세기 동안 회전식 자기 디스크는 데이터 저장소의 중심에 있었다.
다른 형태의 저장소가 있다는 사실 조차도 모를 정도였다.

디스크는 계속 발전해 지름 3인치의 단 몇 그램짜리 얇은 단일 원판으로 1TB 이상 저장 가능하다.
디스크는 느리다는 치명적 단점이 있다.
데이터는 원형 트랙에 저장되고, 트랙은 섹터로 분할되고, 각 섹터는 사용하기 편한 크기의 바이트를 저장하는데 대체로 4K였다.
각 플래터는 대략 수백 개의 트랙으로 구성되었고, 디스크는 십 여 개의 플래터로 구성되었다.
즉, 디스크(1) - (n)플래터(1) - (n)트랙(1) - (n)섹터 - 바이트(대략 4k)로 구성된다.

- 디스크에서 특정 바이트 읽기
  - 모든 작업은 밀리초 단위의 시간이 걸린다.
  1. head를 적절한 트랙으로 옮긴다.
  2. 디스크가 회전하면서 헤드 위치에 적적한 섹터가 올 때 까지 기다린다.
  3. 해당 섹터에서 4k 모두 램으로 읽어들인다.
  4. 해당 램 버퍼의 색인을 찾아 필요 바이트를 가져온다

데이터 저장소가 디스크가 아니라면, 밀리초가 아니라 나노초 수준으로 접근 가능하다.
따라서 디스크의 단점을 완화하기 위해 색인, 캐시, 쿼리 계획 최적화, 데이터 표현 표준 방식이 필요했다.
성능과 작업 대상을 알 수 있어야 했기 때문이다.
즉 데이터 접근 및 관리 시스템이 필요했다.
이는 두 가지 유형으로 나왔다.
1. 파일 시스템
   - 문서 기반
   - 내용 기준 검색은 부적합
     - 파일명을 통해 쉽게 찾지만, 파일의 내용 기반으로 검색하는 것은 어렵고 오래걸린다.
2. RDBMS
   - 내용 기반
   - 내용 기반으로 연관 조회 가능
   - 정형화되지 않은 문서 저장, 검색은 부적합

**디스크가 없다면 어떻게 될까?**
지금은 소멸중인 부품 중 하나다.
머지않아 CD, 테이프 드라이브 등과 같이 소멸의 길로 갈 것이다.
디스크는 RAM으로 대체되고 있다.
모든 데이터가 RAM에 저장된다면 데이터를 어떻게 체계화할 것인가?
다양한 자료구조를 통해 데이터들을 체계화 하고, 데이터 접근시 포인터나 참조를 사용하면 된다.
이것이 프로그래머가 하는 일이다. 그리고 지금도 하고 있는 일이다.

**세부사항**
디비는 결국 세부사항이다.
단지 디스크 표면과 램 사이에서 데이터를 옮길 대 사용한다.
비트를 담는 거대한 그릇이고, 장기적으로 영구히 보관하는 공간일뿐이다.
아키텍처 관점에서는 디스크의 존재도 인식하면 안 된다.

**하지만 성능은?**
데이터 성능은 중요하지만, 저수준의 관심사다.
따라서 시스템의 전반적인 아키텍처와 아무런 관련이 없다.

**개인적인 일화**
디스크에서 데이터를 가져와 데이터를 표현하는 표준 방식 중 파일 시스템과 RDBMS에서
저자의 당시 기업은 파일 시스템 방식이었다.
그 방식이 시스템 아키텍처적으로 옳았다.

그러나 타 부서와 하드웨어 부서에서 RDBMS의 도입을 적극적으로 원했다.
신뢰성과 고객의 원함이었기 때문이다.

시스템 아키텍처적으로 옳던 아니던 RDBMS는 유행이 되어 고객 입장에서 필수 기술(?)이 되어있던 셈이다.
저자는 당사자들과 토론을 했고, 여러 이유로 RDBMS는 도입되었다.
그러나 저자는 그 선택이 옳았다고 한다. 시스템 아키텍처적으로 말고, 다른 이유에서 옳았다고 한다.
이런 일은 경험하지 않았지만 익숙한 환경이다.
기술 선택에 있어서 뿐만 아니고, 이러한 사유로 인한 것들은 뭐가 됐던 익숙한 것 같다.

어쨋든 디비는 세부사항이다. 아키텍처는 데이터의 표현 방식을 알아서는 안되고 관여해서도 안 된다.

```text
느낀점 & 정리

시스템의 아키텍처 방향에서 요구사항 변경은 아니었기 때문에 개인적인 일화의 RDBMS의 도입이 된 것 같다.
도메인 특성상 어떤 것이 유리하던간에 고객과 내부에서 요구하는 방향은 다를 수 있다.
설령 전문가의 의견과 반대되는 의견이라도, 그것이 유행하거나 또는 지향하고자 하는 방향에 따라 그것이 무엇이든간에 선택 될 수 있다.
저자의 개인적인 일화에서 느낀 점은 IT 소프트웨어 개발팀 입장에서 적극적으로 의견을 표명하고 커뮤니케이션했다는 것이다.
어떤 방향으로 색안경을 끼고, 대화 시도에 소극적이 될 수 있는데, 
저자는 앞에서 말했던 IT 개발 팀에 입사한 이유를 지키고 있었다.
어떤 상황에서도 일관적이고 적극적인 태도는 옳은 것 같다. 
```

# 31장 웹은 세부사항이다. 

# 32장 프레임워크는 세부사항이다

# 33장 사례 연구: 비디오 판매

# 34장 빠져 있는 장
