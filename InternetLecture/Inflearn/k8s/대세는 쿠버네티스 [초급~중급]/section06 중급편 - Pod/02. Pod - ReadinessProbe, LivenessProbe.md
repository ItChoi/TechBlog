# 섹션 6. [중급편] Pod

## Pod - ReadinessProbe, LivenessProbe
- 어떤 상황에서 사용하나?
  - 파드 생성시 그 안에 컨테이너가 생기고 파드, 컨테이너 상태가 러닝이 되며 앱이 정상 구동된다.
    - 서비스 IP - 트래픽 발생
      - 2개 파의 파드 존재 -> 50%씩 트래픽 분산
      - Node2 장애 발생 -> 파드 상태 Fail 
      - 한개의 파드에 100% 트래픽
      - 죽은 Pod2는 오토 힐링(자동 복구) 기능에 의해 다른 노드에 재생성 
        - 서비스에 연결 되자마자 Pod2 트래픽 발생
          - 앱 구동 순간에 에러 페이지 발생 -> 파드 생성시 ReadinessProbe를 설정해서 이 문제를 피할 수 있다.
      - 파드 정상, 앱 정상
        - 앱 장애 발생 -> 파드는 여전히 정상
          - LivenessProbe를 설정해서 이 문제를 피할 수 있다.
- ReadinessProbe
  - 앱 구동 전 서비스와 연결이 되지 않는다. 
  - 재생성된 Pod2 상태는 running이어도 앱 구동 전 까지 트래픽은 pod1로만 간다.
- LivenessProbe
  - 앱의 장애 상황을 감지해준다. -> 파드 재실행
    - 잠깐의 트래픽 에러는 존재, 지속적 에러 상태는 방지한다.
- ReadinessProbe, LivenessProbe는 사용 목적이 다를 뿐 설정 내용은 같다.
  - 공통 속성
    - 해당 앱에 대한 상태 확인 가능
    - http-get
      - port
      - host
      - path
      - httpheader
      - scheme
    - exec
      - 명령어를 통해 결과 체크
    - tcpSocket
      - 포트번호,  호스트명을 체크해 ReadinessProbe, LivenessProbe 성공 여부를 확인 가능
  - 옵션
    - initialDelaySeconds: default 0초, 최초 프로브 전 딜레이 시간
    - periodSeconds: default 10초, 프로브 체크 시간 간격
    - timeoutSeconds: default 1초, 이 지정 시간 까지 결과가 와야 한다.
    - successThreshold: default 1회, 몇 번 성공 결과를 받아야 성공으로 인정할건지
    - failureThreshold: default 3회, 몇 번 실패를 받아야 실패로 인정할지