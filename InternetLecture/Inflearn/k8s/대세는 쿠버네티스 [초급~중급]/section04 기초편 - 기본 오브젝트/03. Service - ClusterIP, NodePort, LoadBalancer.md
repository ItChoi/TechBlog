# 섹션 4. [기초편] 기본 오브젝트

## Service - ClusterIP, NodePort, LoadBalancer
- Service
  - 기본적으로 자신의 클러스터 IP를 갖고 있다.
  - Pod와 연결시 - 서비스 IP를 통해서 파드에 접근 가능하다.
    - Pod도 자신의 클러스터 IP를 갖는데, 왜 서비스를 통해서 접근할까?
      - 파드는 시스템, 성능 장애 등으로 종료 될 수 있다. -> 파드 재생성 -> 파드 ip 변경 된다. 
      - 즉 파드 IP는 신뢰성이 떨어지는 반면, 서비스 IP는 직접 삭제하지 않는한 재생성되지 않는다. -> IP 신뢰성
  - Service Type
    - Type마다 파드 접근 방식이 다르다.
    1. ClusterIP
       - 서비스 생성시 기본값
       - k8s 클러스터 내에서만 접근 가능한 IP
         - 파드 IP와 특징이 똑같다.
       - 외부 접근 불가 -> 클러스터 내에서만 사용하는 용도 (운영자, 내부 대쉬보드, 파드 서비스 디버깅)
       - 여러 개 파드 연결시 서비스가 트래픽 분산 -> 파드 전달
    2. NodePort
       - 호스트 IP를 통해 파드 접근 가능 -> 
         - 호스트 IP: 보통 내부망 접근만 가능하도록 네트워크 구성 (내부망 연결, 데모나 임시 연결용 - 노드 포트를 잠깐 허용해 포트포워딩으로 외부 -> 내부 접근 임시 허용)
       - 어떤 노드에서 온 트래픽인지 상관하지 않고, 포함된 파드에게 트래픽 분산 전달
         - externalTrafficPolicy: Local -> 해당 Node 위에 올려진 파드에게만 트래픽 전달!
       - 기본적으로 클러스터 IP는 할당된다.
         - Type: ClusterIP와 같은 기능 포함
       - k8s 클러스터에 연결된 모든 노드에 똑같은 Port 할당
         - 서비스의 파드들은 여러 노드에 포함되어 있을 수 있다.
         - {node_port} -> 서비스를 찾을 수 있다. -> 연결된 파드 트래픽 분산 전달
       - 모든 노드에 Port가 할당된다.
         - 30000 ~ 32767 할당 가능
         - kind: Service / spec.ports.nodePort: 30000 / type: NodePort
           - spec.ports.nodePort 생략시 포트 범위 내에서 자동 할당된다.
    3. LoadBalancer
       - 외부에 시스템 노출 용도!
       - NodePort의 성격을 그대로 갖고 있다.
       - 로드밸런스(IP할당)가 생겨서 각 노드에 트래픽을 분산시켜준다.
         - IP는 개별적으로 K8s 설치시 기본적으로 생기진 않는다.
         - 외부 접속 IP 할당 플러그인 설치 필요 (GCP, k8s 플랫폼 사용시 자체적으로 플러그인이 설치 돼 있다.)
         - 로드밸런스에 할당된 IP가 존재한다면, 외부에서 접근 가능하다.
  