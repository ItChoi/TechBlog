# 섹션 5. [기초편] 컨트롤러

## Replication Controller, ReplicaSet - Template, Replicas, Selector
- Controller 전반적인 이해
  - 서비스 관리, 운영에 큰 도움!
  - Controller가 제공하는 기능
    - Auto Healing
      - 노드 또는 노드 안에 파드가 다운 -> 서비스 장애
      - 서비스 장애 -> Controller 즉각 인지 -> 파드를 다른 노드에 새로 생성
    - Auto Scaling
      - 파드 리소스 limit -> Controller 즉각 인지 -> 파드 추가 후 부하 분산 (안정적 운영)
    - Software Update
      - 컨트롤러를 통해 여러 파드 버전 업그레이드 한 번에 쉽게 가능
      - 업그레이드 문제시 -> 롤백 기능 제공
    - Job
      - 일시적인 작업 -> 컨트롤러가 필요한 순간에만 파드를 만들어 수행 후 삭제
- Replication Controller, ReplicaSet
  - 컨트롤러와 파드는 Label, Selector로 연결된다.
  - Replication Controller
    - 현재 deprecated -> ReplicaSet로 대체 사용
    - 아직 많이 사용
  - Template
    - 컨트롤러 생성시 Template으로 파드 내용을 넣는다.
      - 파드가 종료되면 이 템플릿으로 파드를 재생성
    - 이 특성을 통해 앱 업그레이드 가능 
      - 템플릿에 v2 내용 명시, 기존 v1 파드 다운
    - 파드와 컨트롤러를 따로 만들지 않고, 컨트롤러만 만들면 레플리카 수에 해당하는 파드가 없기 떄문에 템플릿 내용 기반으로 파드를 생성해준다.
      - 실제 컨트롤러만 만들어서 사용한다.
  - Replicas
    - 파드 개수 관리
    - 파드 삭제시 개수만큼 재생성 된다.
    - 파드 개수 상향 조정 -> 스케일 아웃 (파드 생성)
    - 파드 개수 하향 조정 -> 스케일 인 (파드 삭제)
  - Selector
    - Replication -> key: value 모두 같아야 카드들과 연결
    - ReplicaSet에만 있는 기능
      - matchLabels: key, value 모두 같아야 카드들과 연결 (일반적으로 많이 사용)
      - matchExpressions: 조금 더 상세한 서칭 가능 (잘 쓰진 않는다. - 사전에 이미 만들어져 있는 기반으로 쓸 때 사용)
        - Exists: key가 포함된 파드 연결
        - DoesNotExists: key가 포함되지 않은 파드 연결
        - In: or 조건으로 일치하는 파드 연결
        - NotIn: and 조건으로 일치하지 않는 파드 연결